<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>小腾腾的小站 - 赵腾</title><link href="/" rel="alternate"></link><link href="/feeds/zhao-teng.atom.xml" rel="self"></link><id>/</id><updated>2025-02-06T12:00:00+08:00</updated><subtitle>记录技术，分享经验</subtitle><entry><title>Redis面试知识点</title><link href="/2025/02/redismian-shi-zhi-shi-dian.html" rel="alternate"></link><published>2025-02-06T12:00:00+08:00</published><updated>2025-02-06T12:00:00+08:00</updated><author><name>赵腾</name></author><id>tag:None,2025-02-06:/2025/02/redismian-shi-zhi-shi-dian.html</id><summary type="html">&lt;h1&gt;简介&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;关于Redis的面试题，我需要准备一些常见的题目和答案。首先，得确定用户的需求是什么，可能是在准备面试，所以需要覆盖基础到 …&lt;/p&gt;&lt;/blockquote&gt;</summary><content type="html">&lt;h1&gt;简介&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;关于Redis的面试题，我需要准备一些常见的题目和答案。首先，得确定用户的需求是什么，可能是在准备面试，所以需要覆盖基础到进阶的内容。Redis作为缓存和数据库，有很多方面可以讲，比如数据结构、持久化、集群、应用场景等。&lt;/p&gt;
&lt;p&gt;首先，我应该分几个大类来整理问题，比如基础概念、数据结构、持久化机制、高可用性、性能优化、应用场景等。每个类别下选几个典型的问题，这样结构清晰，用户也容易查阅。&lt;/p&gt;
&lt;p&gt;比如基础概念部分，可能需要解释什么是Redis，特点是什么。数据结构方面，Redis支持哪些，各自的使用场景，比如String、Hash、List、Set、Sorted Set，还有高级结构如HyperLogLog、Geo等。持久化方面，RDB和AOF的区别和优缺点，以及如何选择。高可用性的话，主从复制、哨兵、集群的区别。性能优化可能涉及到内存优化、命令使用注意事项。应用场景的话，比如缓存、计数器、消息队列等。&lt;/p&gt;
&lt;p&gt;还要注意一些常见的问题，比如缓存穿透、雪崩、击穿，以及解决方案。事务和管道机制的区别，Redis的线程模型，单线程为什么快。可能还要包括一些实际使用中的问题，比如如何保证数据一致性，淘汰策略，分布式锁的实现等。&lt;/p&gt;
&lt;p&gt;另外，用户可能需要答案简洁明了，适合面试时快速回答。所以每个问题的答案要简明扼要，重点突出，同时涵盖关键点。比如在解释Redis时，可以提到它是内存数据库，支持持久化，丰富的数据结构，单线程模型等。&lt;/p&gt;
&lt;p&gt;还要考虑可能的进阶问题，比如Redis Cluster的工作原理，数据分片，迁移过程，故障转移等。或者Redis的线程模型在6.0之后的变化，多线程处理IO等。这些可能出现在高级职位面试中。&lt;/p&gt;
&lt;p&gt;需要注意的一些陷阱问题，比如Redis是否支持事务，ACID特性如何，这里要说明Redis事务和传统数据库事务的不同，没有回滚机制等。还有内存淘汰策略，比如LRU、LFU的区别和应用场景。&lt;/p&gt;
&lt;p&gt;最后，总结的时候可以提醒用户不仅要记住答案，还要理解背后的原理，结合项目经验举例说明，这样在面试中更有说服力。可能还需要检查是否有遗漏的重要知识点，比如发布订阅功能，慢查询日志，Pipeline批量操作，Lua脚本的使用等。&lt;/p&gt;
&lt;p&gt;总之，整理Redis面试题需要覆盖广泛，结构清晰，答案准确简洁，同时兼顾基础和高级内容，帮助用户全面准备面试&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1&gt;核心内容&lt;/h1&gt;
&lt;p&gt;以下是常见的Redis面试题及其解答，帮助你系统准备Redis相关面试：&lt;/p&gt;
&lt;h2&gt;基本概念和主要特点&lt;/h2&gt;
&lt;h3&gt;Redis 是什么？&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Redis（Remote Dictionary Server）是一个基于内存的高性能键值数据库，支持多种数据结构（String、Hash、List、Set、Sorted Set等）。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Redis 的主要特点&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;内存存储，读写速度快（10万+/秒）。&lt;/li&gt;
&lt;li&gt;支持持久化（RDB、AOF）。&lt;/li&gt;
&lt;li&gt;支持主从复制、哨兵、集群等高可用方案。&lt;/li&gt;
&lt;li&gt;单线程模型避免竞态条件（6.0后支持多线程I/O）。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Redis与Memcached的区别？&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;数据结构&lt;/strong&gt;：Redis支持更丰富的数据结构；Memcached仅支持String。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;持久化&lt;/strong&gt;：Redis支持；Memcached不支持。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;线程模型&lt;/strong&gt;：Redis单线程（6.0后多线程I/O）；Memcached多线程。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;适用场景&lt;/strong&gt;：Redis适合复杂缓存需求；Memcached适合简单KV缓存。&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;数据结构与使用场景&lt;/h2&gt;
&lt;h3&gt;Redis支持哪些数据结构？举例应用场景&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;String&lt;/strong&gt;：计数器（&lt;strong&gt;INCR&lt;/strong&gt;）、缓存。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Hash&lt;/strong&gt;：存储对象（如用户信息）。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;List&lt;/strong&gt;：消息队列、最新文章列表。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Set&lt;/strong&gt;：共同好友（交集）、唯一性检查。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Sorted Set&lt;/strong&gt;：排行榜、延迟队列（按分数排序）。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Bitmaps&lt;/strong&gt;：用户签到、活跃统计。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;HyperLogLog&lt;/strong&gt;：基数统计（如UV）。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;GEO&lt;/strong&gt;：地理位置计算。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Sorted Set底层实现是什么？&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;使用跳跃表（SkipList）和哈希表，保证元素有序且查询高效（O(log N)）。&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;持久化&lt;/h2&gt;
&lt;h3&gt;RDB和AOF的区别？&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;RDB&lt;/strong&gt;（快照）：&lt;ol&gt;
&lt;li&gt;定时生成数据快照，文件紧凑，恢复快。&lt;/li&gt;
&lt;li&gt;缺点：可能丢失最后一次快照后的数据。&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;AOF&lt;/strong&gt;（追加日志）：&lt;ol&gt;
&lt;li&gt;记录所有写命令，数据安全性高（可配置同步频率）。&lt;/li&gt;
&lt;li&gt;缺点：文件较大，恢复慢。&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;混合模式&lt;/strong&gt;（Redis 4.0+）：结合两者，AOF记录增量，RDB作为全量备份。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;如何选择RDB和AOF？&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;要求高可用性选AOF（如&lt;strong&gt;appendfsync everysec&lt;/strong&gt;）。&lt;/li&gt;
&lt;li&gt;需要快速恢复且允许少量数据丢失选RDB。&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;高可用与集群&lt;/h2&gt;
&lt;h3&gt;主从复制原理？&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;主节点（Master）异步复制数据到从节点（Slave）。&lt;/li&gt;
&lt;li&gt;流程：&lt;ol&gt;
&lt;li&gt;Slave发送SYNC命令。&lt;/li&gt;
&lt;li&gt;Master生成RDB快照并发送给Slave。&lt;/li&gt;
&lt;li&gt;Master持续发送缓冲区的写命令给Slave。&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;哨兵（Sentinel）的作用？&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;监控主从节点健康状态。&lt;/li&gt;
&lt;li&gt;自动故障转移：当Master宕机时，选举新Master。&lt;/li&gt;
&lt;li&gt;提供配置中心，客户端通过哨兵获取Master地址。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Redis Cluster如何分片？&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;采用 &lt;strong&gt;哈希槽（Hash Slot）&lt;/strong&gt; 将Key映射到节点，共16384个槽。&lt;/li&gt;
&lt;li&gt;每个节点负责一部分槽，数据按CRC16(key) % 16384分配到槽。&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;缓存问题与解决方案&lt;/h2&gt;
&lt;h3&gt;缓存穿透&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;问题&lt;/strong&gt;：大量请求查询不存在的数据（绕过缓存直接查DB）。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;解决&lt;/strong&gt;：&lt;ol&gt;
&lt;li&gt;布隆过滤器（Bloom Filter）拦截非法Key。&lt;/li&gt;
&lt;li&gt;缓存空值（设置短过期时间）。&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;缓存雪崩&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;问题&lt;/strong&gt;：大量缓存同时过期，请求直接冲击DB。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;解决&lt;/strong&gt;：&lt;ol&gt;
&lt;li&gt;随机化缓存过期时间。&lt;/li&gt;
&lt;li&gt;集群部署或限流降级。&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;缓存击穿&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;问题&lt;/strong&gt;：热点Key过期后，高并发请求瞬间压垮DB。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;解决&lt;/strong&gt;：&lt;ol&gt;
&lt;li&gt;互斥锁（如Redis的&lt;strong&gt;SETNX&lt;/strong&gt;）只允许一个线程重建缓存。&lt;/li&gt;
&lt;li&gt;永不过期（逻辑过期时间+异步更新）。&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;高级特性&lt;/h2&gt;
&lt;h3&gt;Redis事务（MULTI/EXEC）&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;事务命令按顺序执行，但不保证原子性（单条命令原子，事务整体可能部分失败）。&lt;/li&gt;
&lt;li&gt;无回滚机制，需开发者处理逻辑。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Pipeline的作用？&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;批量发送多个命令，减少网络往返时间（RTT），提升吞吐量。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;如何实现分布式锁？&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;使用&lt;strong&gt;SET key value NX PX timeout&lt;/strong&gt;（设置过期时间防死锁）。&lt;/li&gt;
&lt;li&gt;推荐RedLock算法（多节点部署，避免单点故障）。&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;性能优化&lt;/h2&gt;
&lt;h3&gt;为什么Redis单线程还快？&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;纯内存操作。&lt;/li&gt;
&lt;li&gt;避免线程切换和竞态开销。&lt;/li&gt;
&lt;li&gt;I/O多路复用（epoll）处理高并发连接。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Big Key问题如何解决？&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;拆分大Key（如Hash分多个字段）。&lt;/li&gt;
&lt;li&gt;删除时使用&lt;strong&gt;UNLINK&lt;/strong&gt;（异步删除）。&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;常见命令&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;查看所有Key：&lt;strong&gt;SCAN&lt;/strong&gt;（避免阻塞，代替 KEYS *）。&lt;/li&gt;
&lt;li&gt;设置过期时间：&lt;strong&gt;EXPIRE key seconds&lt;/strong&gt;。&lt;/li&gt;
&lt;li&gt;查看内存信息：&lt;strong&gt;INFO MEMORY&lt;/strong&gt;。&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;总结&lt;/h1&gt;
&lt;p&gt;准备Redis面试需深入理解数据结构、持久化、高可用方案及典型问题（穿透/雪崩/击穿）。
结合实际项目经验，说明如何应用Redis解决具体问题（如分布式锁、排行榜等），会更具说服力。&lt;/p&gt;</content><category term="技术"></category><category term="编程"></category><category term="Cache"></category></entry><entry><title>Spring Cloud Gateway 深度解析：路由、过滤与安全</title><link href="/2024/11/spring-cloud-gateway-shen-du-jie-xi-lu-you-guo-lu-yu-an-quan.html" rel="alternate"></link><published>2024-11-21T12:00:00+08:00</published><updated>2024-11-21T12:00:00+08:00</updated><author><name>赵腾</name></author><id>tag:None,2024-11-21:/2024/11/spring-cloud-gateway-shen-du-jie-xi-lu-you-guo-lu-yu-an-quan.html</id><summary type="html">&lt;h1&gt;简介&lt;/h1&gt;
&lt;p&gt;Spring Cloud Gateway 是微服务架构中的关键组件，用于管理微服务之间的流量。
本文将深入解析 Spring Cloud Gateway 的核心功能，包括路由配置 …&lt;/p&gt;</summary><content type="html">&lt;h1&gt;简介&lt;/h1&gt;
&lt;p&gt;Spring Cloud Gateway 是微服务架构中的关键组件，用于管理微服务之间的流量。
本文将深入解析 Spring Cloud Gateway 的核心功能，包括路由配置、过滤器使用和安全防护。
我们将通过具体的示例和最佳实践，展示如何高效地配置路由规则、使用各种过滤器优化请求处理，并实施安全措施保护微服务入口。
无论你是初学者还是有经验的开发者，本文都将为你提供宝贵的参考和指导，帮助你在微服务开发中更有效地利用 Spring Cloud Gateway。&lt;/p&gt;
&lt;h1&gt;核心内容&lt;/h1&gt;
&lt;h2&gt;基本概念和主要特点&lt;/h2&gt;
&lt;h3&gt;Spring Cloud Gateway 是什么？&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Spring Cloud Gateway 是 Spring Cloud 生态系统中的新一代 API 网关。&lt;/li&gt;
&lt;li&gt;它基于 Reactor 模型，提供了高性能的路由和过滤功能，用于管理微服务之间的流量。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Spring Cloud Gateway 的主要特点&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;路由功能&lt;/strong&gt;：灵活的路由配置，支持多种匹配条件。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;过滤器&lt;/strong&gt;：丰富的过滤器类型，用于请求和响应的预处理和后处理。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;安全性&lt;/strong&gt;：集成 OAuth2、JWT 等安全机制，保护微服务入口。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;高可用&lt;/strong&gt;：支持负载均衡和故障转移，提高系统的可用性。&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;快速入门&lt;/h2&gt;
&lt;h3&gt;环境准备&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;确保已安装 JDK 和 Maven。&lt;/li&gt;
&lt;li&gt;创建一个新的 Spring Boot 项目。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;添加依赖&lt;/h3&gt;
&lt;p&gt;在 &lt;code&gt;pom.xml&lt;/code&gt; 文件中添加 Spring Cloud Gateway 的依赖：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nt"&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.springframework.cloud&lt;span class="nt"&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;spring-cloud-starter-gateway&lt;span class="nt"&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3&gt;配置路由&lt;/h3&gt;
&lt;p&gt;在 &lt;code&gt;application.yml&lt;/code&gt; 中配置路由规则：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;spring&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;cloud&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;gateway&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;routes&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;service&lt;/span&gt;
&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="n"&gt;uri&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;lb&lt;/span&gt;&lt;span class="o"&gt;://&lt;/span&gt;&lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;service&lt;/span&gt;
&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="n"&gt;predicates&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Path&lt;/span&gt;&lt;span class="o"&gt;=/&lt;/span&gt;&lt;span class="n"&gt;users&lt;/span&gt;&lt;span class="o"&gt;/**&lt;/span&gt;
&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="n"&gt;filters&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;StripPrefix&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3&gt;启动应用&lt;/h3&gt;
&lt;p&gt;创建一个简单的 Spring Boot 应用并启动：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nv"&gt;@SpringBootApplication&lt;/span&gt;
&lt;span class="k"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GatewayApplication&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;static&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;main&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="err"&gt;[]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;SpringApplication&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;run&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;GatewayApplication&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="err"&gt;}&lt;/span&gt;
&lt;span class="err"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2&gt;路由配置详解&lt;/h2&gt;
&lt;h3&gt;路由基础&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;路由 ID&lt;/strong&gt;：唯一标识一个路由。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;URI&lt;/strong&gt;：目标服务的地址，支持 http、lb（负载均衡）等协议。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Predicates&lt;/strong&gt;：路由匹配条件，支持多种类型（如 Path、Query、Header 等）。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Filters&lt;/strong&gt;：路由过滤器，用于请求和响应的预处理和后处理。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;复杂路由示例&lt;/h3&gt;
&lt;p&gt;配置多个路由规则，使用不同的匹配条件：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;spring&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;cloud&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;gateway&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;routes&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;service&lt;/span&gt;
&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="n"&gt;uri&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;lb&lt;/span&gt;&lt;span class="o"&gt;://&lt;/span&gt;&lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;service&lt;/span&gt;
&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="n"&gt;predicates&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Path&lt;/span&gt;&lt;span class="o"&gt;=/&lt;/span&gt;&lt;span class="n"&gt;users&lt;/span&gt;&lt;span class="o"&gt;/**&lt;/span&gt;
&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="n"&gt;filters&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;StripPrefix&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;order&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;service&lt;/span&gt;
&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="n"&gt;uri&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;lb&lt;/span&gt;&lt;span class="o"&gt;://&lt;/span&gt;&lt;span class="n"&gt;order&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;service&lt;/span&gt;
&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="n"&gt;predicates&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Path&lt;/span&gt;&lt;span class="o"&gt;=/&lt;/span&gt;&lt;span class="n"&gt;orders&lt;/span&gt;&lt;span class="o"&gt;/**&lt;/span&gt;
&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="n"&gt;filters&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;AddRequestHeader&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;User&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;Id&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;123&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2&gt;过滤器详解&lt;/h2&gt;
&lt;h3&gt;内置过滤器&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;AddRequestHeader：添加请求头。&lt;/li&gt;
&lt;li&gt;RemoveRequestHeader：移除请求头。&lt;/li&gt;
&lt;li&gt;AddResponseHeader：添加响应头。&lt;/li&gt;
&lt;li&gt;StripPrefix：移除路径前缀。&lt;/li&gt;
&lt;li&gt;RewritePath：重写路径。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;自定义过滤器&lt;/h3&gt;
&lt;p&gt;创建一个自定义的全局过滤器：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="err"&gt;@&lt;/span&gt;&lt;span class="nx"&gt;Component&lt;/span&gt;
&lt;span class="nx"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;CustomGlobalFilter&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;implements&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;GlobalFilter&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;Ordered&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="err"&gt;@&lt;/span&gt;&lt;span class="nx"&gt;Override&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nx"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;Mono&lt;/span&gt;&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;Void&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;filter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;ServerWebExchange&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;exchange&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;GatewayFilterChain&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;chain&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nx"&gt;ServerHttpRequest&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;request&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;exchange&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;getRequest&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nx"&gt;System&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;out&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;println&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Request path: &amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;request&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;getURI&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="nx"&gt;getPath&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;chain&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;filter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;exchange&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="err"&gt;@&lt;/span&gt;&lt;span class="nx"&gt;Override&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nx"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;getOrder&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2&gt;安全防护&lt;/h2&gt;
&lt;h3&gt;集成 OAuth2&lt;/h3&gt;
&lt;p&gt;配置 OAuth2 安全认证：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;spring&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;security&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;oauth2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;resourceserver&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;jwt&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="n"&gt;issuer&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;uri&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;://&lt;/span&gt;&lt;span class="n"&gt;localhost&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;8080&lt;/span&gt;&lt;span class="sr"&gt;/auth/realms/&lt;/span&gt;&lt;span class="n"&gt;my&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;realm&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3&gt;使用 JWT&lt;/h3&gt;
&lt;p&gt;配置 JWT 认证：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;spring&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;security&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;oauth2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;resourceserver&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;jwt&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="n"&gt;jwk&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="kd"&gt;set&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;uri&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;://&lt;/span&gt;&lt;span class="n"&gt;localhost&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;8080&lt;/span&gt;&lt;span class="sr"&gt;/auth/realms/my-realm/protocol/openid-connect/&lt;/span&gt;&lt;span class="n"&gt;certs&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3&gt;安全过滤器&lt;/h3&gt;
&lt;p&gt;创建一个安全过滤器，验证 JWT 令牌：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="err"&gt;@&lt;/span&gt;&lt;span class="nx"&gt;Component&lt;/span&gt;
&lt;span class="nx"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;JwtAuthenticationFilter&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;implements&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;GlobalFilter&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;Ordered&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="err"&gt;@&lt;/span&gt;&lt;span class="nx"&gt;Override&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nx"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;Mono&lt;/span&gt;&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;Void&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;filter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;ServerWebExchange&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;exchange&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;GatewayFilterChain&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;chain&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nx"&gt;ServerHttpRequest&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;request&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;exchange&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;getRequest&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nx"&gt;String&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;token&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;request&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;getHeaders&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="nx"&gt;getFirst&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Authorization&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;token&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;!=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;null&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;token&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;startsWith&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Bearer &amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="nx"&gt;try&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="c1"&gt;// 验证 JWT 令牌&lt;/span&gt;
&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="c1"&gt;// ...&lt;/span&gt;
&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;chain&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;filter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;exchange&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;catch&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;Exception&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;e&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="c1"&gt;// 处理验证失败的情况&lt;/span&gt;
&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;Mono&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;error&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;RuntimeException&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Invalid token&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;Mono&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;error&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;RuntimeException&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Missing token&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="err"&gt;@&lt;/span&gt;&lt;span class="nx"&gt;Override&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nx"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;getOrder&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2&gt;最佳实践&lt;/h2&gt;
&lt;h3&gt;代码组织&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;将路由配置和过滤器逻辑分开，便于管理和维护。&lt;/li&gt;
&lt;li&gt;使用配置文件管理复杂的路由规则。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;错误处理&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;使用统一的异常处理机制，捕获并处理路由和过滤器中的异常。&lt;/li&gt;
&lt;li&gt;提供友好的错误提示信息。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;性能优化&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;合理设置超时时间，避免长时间等待。&lt;/li&gt;
&lt;li&gt;使用缓存机制，减少不必要的网络请求。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;安全性&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;使用 HTTPS 协议，保证数据传输的安全性。&lt;/li&gt;
&lt;li&gt;配置身份验证和授权，保护服务接口。&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;总结&lt;/h1&gt;
&lt;p&gt;通过本文，我们详细介绍了 Spring Cloud Gateway 的基本用法、高级特性和最佳实践，
帮助读者在微服务开发中更高效地使用 Spring Cloud Gateway。&lt;/p&gt;</content><category term="技术"></category><category term="编程"></category><category term="Java"></category><category term="SpringCloud"></category><category term="微服务"></category></entry><entry><title>Feign 客户端：简化微服务间通信的艺术</title><link href="/2024/11/feign-ke-hu-duan-jian-hua-wei-fu-wu-jian-tong-xin-de-yi-zhu.html" rel="alternate"></link><published>2024-11-20T18:00:00+08:00</published><updated>2024-11-20T18:00:00+08:00</updated><author><name>赵腾</name></author><id>tag:None,2024-11-20:/2024/11/feign-ke-hu-duan-jian-hua-wei-fu-wu-jian-tong-xin-de-yi-zhu.html</id><summary type="html">&lt;h1&gt;简介&lt;/h1&gt;
&lt;p&gt;随着微服务架构的普及，服务间的高效通信变得尤为重要。
Feign 作为 Spring Cloud 生态系统中的声明式 HTTP 客户端，极大地简化了 …&lt;/p&gt;</summary><content type="html">&lt;h1&gt;简介&lt;/h1&gt;
&lt;p&gt;随着微服务架构的普及，服务间的高效通信变得尤为重要。
Feign 作为 Spring Cloud 生态系统中的声明式 HTTP 客户端，极大地简化了微服务之间的调用。
本文将详细介绍 Feign 的基本概念、核心功能以及高级特性，包括如何在 Spring Boot 项目中集成 Feign、
配置超时和日志记录、实现熔断和重试策略、结合 Ribbon 实现负载均衡等。
通过具体的示例和最佳实践，帮助读者在实际项目中更高效地使用 Feign，提升微服务架构的稳定性和性能。&lt;/p&gt;
&lt;h1&gt;核心内容&lt;/h1&gt;
&lt;h2&gt;基本概念和主要特点&lt;/h2&gt;
&lt;h3&gt;Feign 是什么？&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Feign 是一个声明式的 HTTP 客户端，用于简化 HTTP API 的调用。&lt;/li&gt;
&lt;li&gt;它通过注解的方式定义服务接口，自动生成 HTTP 请求，减少了样板代码。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Feign 的主要特点&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;声明式接口&lt;/strong&gt;：通过简单的注解定义服务接口。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;自动转换&lt;/strong&gt;：支持自动将请求参数和响应数据转换为 Java 对象。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;集成 Hystrix&lt;/strong&gt;：内置熔断机制，提高系统的容错性和稳定性。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;负载均衡&lt;/strong&gt;：结合 Ribbon 实现客户端负载均衡，提高服务的可用性。&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;快速入门&lt;/h2&gt;
&lt;h3&gt;环境准备&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;确保已安装 JDK 和 Maven。&lt;/li&gt;
&lt;li&gt;创建一个新的 Spring Boot 项目。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;添加依赖&lt;/h3&gt;
&lt;p&gt;在 &lt;code&gt;pom.xml&lt;/code&gt; 文件中添加 Feign 的依赖：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nt"&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.springframework.cloud&lt;span class="nt"&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;spring-cloud-starter-openfeign&lt;span class="nt"&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3&gt;启用 Feign 客户端&lt;/h3&gt;
&lt;p&gt;在主类或配置类上添加 &lt;code&gt;@EnableFeignClients&lt;/code&gt; 注解：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nv"&gt;@SpringBootApplication&lt;/span&gt;
&lt;span class="nv"&gt;@EnableFeignClients&lt;/span&gt;
&lt;span class="k"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Application&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;static&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;main&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="err"&gt;[]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;SpringApplication&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;run&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Application&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="err"&gt;}&lt;/span&gt;
&lt;span class="err"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3&gt;定义 Feign 客户端&lt;/h3&gt;
&lt;p&gt;创建一个接口来定义服务调用：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nv"&gt;@RestController&lt;/span&gt;
&lt;span class="k"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;UserController&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nv"&gt;@Autowired&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;UserClient&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;userClient&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nv"&gt;@GetMapping&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;/user/{id}&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;User&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;getUser&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;@PathVariable&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;id&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Long&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;userClient&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;getUserById&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="err"&gt;}&lt;/span&gt;
&lt;span class="err"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2&gt;高级特性&lt;/h2&gt;
&lt;h3&gt;超时设置&lt;/h3&gt;
&lt;p&gt;在 &lt;code&gt;application.yml&lt;/code&gt; 中配置超时时间：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;  client:
    config:
      default:
        connectTimeout: 5000
        readTimeout: 5000
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3&gt;日志记录&lt;/h3&gt;
&lt;p&gt;在 &lt;code&gt;application.yml&lt;/code&gt; 中配置日志级别：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;logging&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;level&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;example&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;client&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;UserClient&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DEBUG&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3&gt;熔断机制（Hystrix）&lt;/h3&gt;
&lt;p&gt;启用 Hystrix 并配置回退方法：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="err"&gt;@&lt;/span&gt;&lt;span class="nx"&gt;FeignClient&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;name&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;user-service&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;fallback&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;UserClientFallback&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nx"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;interface&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;UserClient&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="err"&gt;@&lt;/span&gt;&lt;span class="nx"&gt;GetMapping&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;/users/{id}&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nx"&gt;User&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;getUserById&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="err"&gt;@&lt;/span&gt;&lt;span class="nx"&gt;PathVariable&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;id&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;Long&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;id&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="err"&gt;@&lt;/span&gt;&lt;span class="nx"&gt;Component&lt;/span&gt;
&lt;span class="nx"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;class&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;UserClientFallback&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;implements&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;UserClient&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="err"&gt;@&lt;/span&gt;&lt;span class="nx"&gt;Override&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nx"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;User&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;getUserById&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;Long&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;id&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;User&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="nx"&gt;L&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Unknown&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3&gt;重试策略&lt;/h3&gt;
&lt;p&gt;在 &lt;code&gt;application.yml&lt;/code&gt; 中配置重试次数：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;feign&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;config&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="k"&gt;default&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;retryer&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;example&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;config&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;MyRetryer&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;创建自定义的重试器：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MyRetryer&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;extends&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Retryer&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Default&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;public&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MyRetryer&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;super&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3&gt;负载均衡（Ribbon）&lt;/h3&gt;
&lt;p&gt;确保已添加 Ribbon 的依赖：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nt"&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.springframework.cloud&lt;span class="nt"&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;spring-cloud-starter-netflix-ribbon&lt;span class="nt"&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;在 &lt;code&gt;application.yml&lt;/code&gt; 中配置 Ribbon：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;ribbon&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;ReadTimeout&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;5000&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;ConnectTimeout&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;5000&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;MaxAutoRetries&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;MaxAutoRetriesNextServer&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;OkToRetryOnAllOperations&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kc"&gt;true&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2&gt;最佳实践&lt;/h2&gt;
&lt;h3&gt;代码组织&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;将 Feign 客户端放在单独的包中，便于管理和维护。&lt;/li&gt;
&lt;li&gt;使用接口隔离原则，避免单一接口过于臃肿。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;错误处理&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;使用统一的异常处理机制，捕获并处理 Feign 调用中的异常。&lt;/li&gt;
&lt;li&gt;提供友好的错误提示信息。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;性能优化&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;合理设置超时时间，避免长时间等待。&lt;/li&gt;
&lt;li&gt;使用缓存机制，减少不必要的网络请求。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;安全性&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;使用 HTTPS 协议，保证数据传输的安全性。&lt;/li&gt;
&lt;li&gt;配置身份验证和授权，保护服务接口。&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;总结&lt;/h1&gt;
&lt;p&gt;通过本文，我们详细介绍了 Feign 的基本概念、核心功能和高级特性，并提供了具体的示例和最佳实践。
希望本文能帮助读者在微服务开发中更高效地使用 Feign，提升系统的稳定性和性能。&lt;/p&gt;</content><category term="技术"></category><category term="编程"></category><category term="Java"></category><category term="SpringCloud"></category><category term="微服务"></category></entry><entry><title>带你快速写出简洁优秀的博客</title><link href="/2024/11/dai-ni-kuai-su-xie-chu-jian-ji-you-xiu-de-bo-ke.html" rel="alternate"></link><published>2024-11-18T10:25:00+08:00</published><updated>2024-11-18T10:25:00+08:00</updated><author><name>赵腾</name></author><id>tag:None,2024-11-18:/2024/11/dai-ni-kuai-su-xie-chu-jian-ji-you-xiu-de-bo-ke.html</id><summary type="html">&lt;h1&gt;简介&lt;/h1&gt;
&lt;p&gt;本文介绍如何快速写出简洁优秀的博客。&lt;/p&gt;
&lt;h1&gt;核心内容&lt;/h1&gt;
&lt;p&gt;想写出简洁优秀的博客，必须包含以下几个部分：&lt;/p&gt;
&lt;h2&gt;标题（Title）&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;主题明确 …&lt;/strong&gt;&lt;/li&gt;&lt;/ul&gt;</summary><content type="html">&lt;h1&gt;简介&lt;/h1&gt;
&lt;p&gt;本文介绍如何快速写出简洁优秀的博客。&lt;/p&gt;
&lt;h1&gt;核心内容&lt;/h1&gt;
&lt;p&gt;想写出简洁优秀的博客，必须包含以下几个部分：&lt;/p&gt;
&lt;h2&gt;标题（Title）&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;主题明确&lt;/strong&gt;：标题要直接体现博客的核心技术主题，让读者能迅速判断内容是否是自己需要的。例如，“快速掌握 JavaScript 闭包”“高效使用 Docker 容器部署”。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;吸引力元素&lt;/strong&gt;：添加能引起读者兴趣的词汇，如 “高效”“简易”“深度解析”“实战” 等。像 “实战演练：用 Python 进行数据分析” 这样的标题就更具吸引力。&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;简介（Introduction）&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;背景铺垫（可选）&lt;/strong&gt;：用简短的几句话介绍技术主题的背景，让读者了解该技术出现的原因或在当前技术生态中的地位。例如，在介绍微服务架构时可以说：“随着软件系统的规模和复杂度不断增加，传统的单体架构面临诸多挑战，微服务架构应运而生，为构建灵活、可扩展的系统提供了解决方案。”&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;目的阐述&lt;/strong&gt;：明确写出这篇博客的目的，如讲解一个概念、分享一种实践经验或解决一个常见问题。例如：“本文旨在通过简单易懂的方式讲解数据库事务的概念，并展示如何在实际的 SQL 编程中正确运用事务。”&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;核心内容（Core Content）&lt;/h2&gt;
&lt;h3&gt;核心知识讲解：&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;概念阐述&lt;/strong&gt;：简洁地解释关键技术概念，避免复杂的定义方式。例如，解释区块链的概念可以说 “区块链是一种去中心化的分布式账本，数据以块的形式存储，通过密码学保证安全。”&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;关键原理说明&lt;/strong&gt;：用简单的语言剖析技术的关键原理。对于复杂原理，可以采用举例或类比的方式。如解释搜索引擎的索引原理时，可以说 “搜索引擎就像图书馆的索引卡片，它会记录网页的关键信息，当用户搜索时，能快速找到相关网页。”&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;实践操作（若有）：&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;步骤简述：如果涉及技术操作，如软件安装、代码编写等，用序号列出主要步骤。以安装 Node.js 为例：“1. 访问官网；2. 下载适合你系统的安装包；3. 双击安装包，按照提示完成安装。”&lt;/li&gt;
&lt;li&gt;代码示例（编程类）：对于编程主题，提供简洁的代码片段，并简单注释主要功能。例如：&lt;/li&gt;
&lt;li&gt;案例分享（可选）：如果合适，简要分享一个应用案例，描述问题和解决方案。如 “某电商网站使用缓存技术（介绍技术）来提高页面加载速度，减少服务器压力，提升用户体验。”&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;总结（Summary）&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;内容回顾&lt;/strong&gt;：简要回顾博客主体内容，重点提及核心知识和重要操作。例如，“本文介绍了数据库索引的概念和原理，以及如何创建简单的索引来提高查询效率。”&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;价值强调&lt;/strong&gt;：强调博客内容对读者的价值，如 “希望这些知识能帮助你在数据库优化工作中快速上手。”&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;参考资料（References）（可选）&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;引用标注&lt;/strong&gt;：如果引用了其他资料，在文中合适位置标注，在结尾列出参考资料来源。例如，在文中提到某研究成果时，标注 [1]，在结尾列出 [1] 对应的书籍或文章信息。&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;总结&lt;/h1&gt;
&lt;p&gt;简洁优秀的博客应该包含以下几个部分：主题明确且有吸引力的标题、阐述文章目的和背景（可选）的简介、核心内容、总结、参考资料（可选）。&lt;/p&gt;</content><category term="生活记录"></category><category term="写作"></category></entry></feed>